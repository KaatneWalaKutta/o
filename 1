Client-Side Remote Code Execution (RCE) via eval() Sink

The application utilizes a custom Streamlit component (JavascriptComponent) that exposes a dangerous sink. Analysis of the reconstructed source code from the exposed .map files reveals that the component accepts a property named js_code from the backend and passes it directly into a JavaScript eval() function.

The developer intentionally bypassed security linting (using // eslint-disable-next-line) to implement this functionality. Because eval() executes strings with the same privileges as the application, any compromise of the data stream or the backend's logic allows an attacker to execute arbitrary JavaScript in the user's browser context.

Eliminate eval(): Replace the dynamic execution of strings with a pre-defined library of "Safe Actions." If the component needs to get window dimensions, hardcode a getWindowSize() function and trigger it via a constant string (e.g., ACTION_GET_DIMENSIONS).

Remove Source Maps: Disable the generation of .map files in the production build pipeline to prevent attackers from reconstructing the application's internal logic.

Implement Content Security Policy (CSP): Deploy a strict CSP that disallows 'unsafe-eval' to provide a defense-in-depth layer that prevents the browser from executing code via eval() even if the sink remains.


Since environmental restrictions prevent active Hex injection, the vulnerability is proven via the leaked source code:










Sensitive Information disclosure: in websocket traffic:


The hex string you provided decodes into a structured data format, likely Protocol Buffers (protobuf), which is commonly used by Streamlit to synchronize state between the Python backend and the React frontend.

Decoded Data Summary
The decoded bytes reveal a configuration for a Streamlit application, including session identifiers, environment details, font styling, and page navigation structures.

1. Environment & Versioning
Streamlit Version: 1.45.1

Python Version: 3.12.12.final.0

Operating System: linux

Machine ID: no-machine-id-v4 (indicating a containerized or generic environment)

2. Session & Application Identity
Session ID/Key: d67e102b-0c48-5d12-9ebe-47e6719e782d

App Script: Home.py








Vulnerability: Exposed Source Map Files (.map) Allowing Frontend Source Code Reconstruction

Description:
The application exposes JavaScript source map files (.js.map) in the production environment. These files are intended for debugging purposes during development and can contain original source code, file structure, and function names.

Using these exposed .map files, it was possible to reconstruct the application's frontend source code. This can help an attacker understand the client-side logic, uncover hidden API endpoints, debug information, hardcoded secrets (in some cases), and identify potential vulnerabilities (e.g., IDOR, hidden functionality).

Affected URL:
https://example.com/static/js/app.js.map
(and similar)

Steps to Reproduce:

Visit the main site and open Developer Tools > Network tab.

Observe the JavaScript files being loaded, such as:

Impact:

Disclosure of internal implementation logic.

Easier identification of sensitive client-side logic.

Potential exposure of insecure API interactions.

Increased risk of further targeted attacks.

Remediation:

Do not deploy .map files to production environments. Ensure your CI/CD pipelines strip them from builds intended for deployment.

Review current web server configurations to restrict access to *.map files.

Conduct an internal code review to ensure no secrets or sensitive logic were exposed through source maps.

